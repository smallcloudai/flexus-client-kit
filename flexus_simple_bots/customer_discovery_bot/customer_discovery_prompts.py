import json

BOT_PERSONALITY_MD = "You are a Discovery Operator. You run structured discovery workflows and keep evidence quality high."
BOT_EXPERTS = json.loads("[{\"name\": \"default\", \"fexp_description\": \"Default route for discovery operations\", \"fexp_allow_tools\": \"flexus_policy_document,print_widget,discovery_survey_design_api,discovery_survey_collection_api,discovery_context_import_api\", \"fexp_block_tools\": \"\", \"skills\": [\"skill_past_behavior_questioning\", \"skill_jtbd_outcome_formatting\"], \"body_md\": \"Route to discovery instrument design, participant recruitment, or JTBD interview operations.\"}, {\"name\": \"discovery_instrument_designer\", \"fexp_description\": \"Design high-quality interview and survey instruments\", \"fexp_allow_tools\": \"flexus_policy_document,print_widget,discovery_survey_design_api,discovery_survey_collection_api,discovery_context_import_api\", \"fexp_block_tools\": \"\", \"skills\": [\"skill_past_behavior_questioning\", \"skill_jtbd_outcome_formatting\"], \"pdoc_output_schemas\": [{\"schema_name\": \"interview_instrument_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"instrument_id\", \"research_goal\", \"target_segment\", \"hypothesis_refs\", \"interview_mode\", \"question_blocks\", \"probe_bank\", \"bias_controls\", \"consent_protocol\", \"completion_criteria\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"interview_instrument\"]}, \"version\": {\"type\": \"string\"}, \"instrument_id\": {\"type\": \"string\"}, \"research_goal\": {\"type\": \"string\"}, \"target_segment\": {\"type\": \"string\"}, \"hypothesis_refs\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"interview_mode\": {\"type\": \"string\", \"enum\": [\"live_video\", \"live_audio\", \"async_text\"]}, \"question_blocks\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"question_id\", \"question_text\", \"evidence_objective\", \"question_type\", \"forbidden_patterns\"], \"additionalProperties\": false, \"properties\": {\"question_id\": {\"type\": \"string\"}, \"question_text\": {\"type\": \"string\"}, \"evidence_objective\": {\"type\": \"string\"}, \"question_type\": {\"type\": \"string\", \"enum\": [\"past_behavior\", \"timeline\", \"switch_trigger\", \"decision_criteria\", \"objection_probe\"]}, \"forbidden_patterns\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, \"probe_bank\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"bias_controls\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"consent_protocol\": {\"type\": \"object\", \"required\": [\"consent_required\", \"recording_policy\"], \"additionalProperties\": false, \"properties\": {\"consent_required\": {\"type\": \"boolean\"}, \"recording_policy\": {\"type\": \"string\"}}}, \"completion_criteria\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, {\"schema_name\": \"survey_instrument_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"instrument_id\", \"survey_goal\", \"target_segment\", \"hypothesis_refs\", \"sample_plan\", \"questions\", \"branching_rules\", \"quality_controls\", \"analysis_plan\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"survey_instrument\"]}, \"version\": {\"type\": \"string\"}, \"instrument_id\": {\"type\": \"string\"}, \"survey_goal\": {\"type\": \"string\"}, \"target_segment\": {\"type\": \"string\"}, \"hypothesis_refs\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"sample_plan\": {\"type\": \"object\", \"required\": [\"target_n\", \"min_n_per_segment\"], \"additionalProperties\": false, \"properties\": {\"target_n\": {\"type\": \"integer\", \"minimum\": 1}, \"min_n_per_segment\": {\"type\": \"integer\", \"minimum\": 1}}}, \"questions\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"question_id\", \"question_text\", \"response_type\"], \"additionalProperties\": false, \"properties\": {\"question_id\": {\"type\": \"string\"}, \"question_text\": {\"type\": \"string\"}, \"response_type\": {\"type\": \"string\", \"enum\": [\"single_select\", \"multi_select\", \"likert\", \"numeric\", \"free_text\"]}, \"answer_scale\": {\"type\": \"string\"}}}}, \"branching_rules\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"quality_controls\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"analysis_plan\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, {\"schema_name\": \"discovery_instrument_readiness_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"instrument_id\", \"readiness_state\", \"blocking_issues\", \"recommended_fixes\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"discovery_instrument_readiness\"]}, \"version\": {\"type\": \"string\"}, \"instrument_id\": {\"type\": \"string\"}, \"readiness_state\": {\"type\": \"string\", \"enum\": [\"ready\", \"revise\", \"blocked\"]}, \"blocking_issues\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"recommended_fixes\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}], \"body_md\": \"Design and version discovery instruments mapped to explicit hypotheses, sample plan, and bias controls; fail fast when hypotheses or target segment are underspecified.\"}, {\"name\": \"participant_recruitment_operator\", \"fexp_description\": \"Recruit participants for surveys, interviews, and usability tests across panel providers\", \"fexp_allow_tools\": \"flexus_policy_document,print_widget,discovery_panel_recruitment_api,discovery_customer_panel_api,discovery_test_recruitment_api,discovery_interview_scheduling_api,discovery_survey_collection_api,discovery_context_import_api\", \"fexp_block_tools\": \"\", \"skills\": [], \"pdoc_output_schemas\": [{\"schema_name\": \"participant_recruitment_plan_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"plan_id\", \"study_type\", \"target_segment\", \"quota_cells\", \"channels\", \"inclusion_criteria\", \"exclusion_criteria\", \"incentive_policy\", \"timeline\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"participant_recruitment_plan\"]}, \"version\": {\"type\": \"string\"}, \"plan_id\": {\"type\": \"string\"}, \"study_type\": {\"type\": \"string\", \"enum\": [\"survey\", \"interview\", \"usability_test\", \"mixed\"]}, \"target_segment\": {\"type\": \"string\"}, \"quota_cells\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"cell_id\", \"target_n\"], \"additionalProperties\": false, \"properties\": {\"cell_id\": {\"type\": \"string\"}, \"target_n\": {\"type\": \"integer\", \"minimum\": 1}}}}, \"channels\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"inclusion_criteria\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"exclusion_criteria\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"incentive_policy\": {\"type\": \"object\", \"required\": [\"currency\", \"amount_range\"], \"additionalProperties\": false, \"properties\": {\"currency\": {\"type\": \"string\"}, \"amount_range\": {\"type\": \"string\"}}}, \"timeline\": {\"type\": \"object\", \"required\": [\"launch_date\", \"target_close_date\"], \"additionalProperties\": false, \"properties\": {\"launch_date\": {\"type\": \"string\"}, \"target_close_date\": {\"type\": \"string\"}}}}}}, {\"schema_name\": \"recruitment_funnel_snapshot_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"plan_id\", \"snapshot_ts\", \"provider_breakdown\", \"overall_status\", \"dropoff_reasons\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"recruitment_funnel_snapshot\"]}, \"version\": {\"type\": \"string\"}, \"plan_id\": {\"type\": \"string\"}, \"snapshot_ts\": {\"type\": \"string\"}, \"provider_breakdown\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"provider\", \"invited\", \"started\", \"qualified\", \"completed\"], \"additionalProperties\": false, \"properties\": {\"provider\": {\"type\": \"string\"}, \"invited\": {\"type\": \"integer\", \"minimum\": 0}, \"started\": {\"type\": \"integer\", \"minimum\": 0}, \"qualified\": {\"type\": \"integer\", \"minimum\": 0}, \"completed\": {\"type\": \"integer\", \"minimum\": 0}}}}, \"overall_status\": {\"type\": \"string\", \"enum\": [\"on_track\", \"at_risk\", \"blocked\"]}, \"dropoff_reasons\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, {\"schema_name\": \"recruitment_compliance_quality_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"plan_id\", \"quality_checks\", \"fraud_signals\", \"consent_traceability\", \"pass_fail\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"recruitment_compliance_quality\"]}, \"version\": {\"type\": \"string\"}, \"plan_id\": {\"type\": \"string\"}, \"quality_checks\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"check_id\", \"result\", \"notes\"], \"additionalProperties\": false, \"properties\": {\"check_id\": {\"type\": \"string\"}, \"result\": {\"type\": \"string\", \"enum\": [\"pass\", \"warn\", \"fail\"]}, \"notes\": {\"type\": \"string\"}}}}, \"fraud_signals\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"consent_traceability\": {\"type\": \"string\", \"enum\": [\"complete\", \"partial\", \"missing\"]}, \"pass_fail\": {\"type\": \"string\", \"enum\": [\"pass\", \"fail\"]}}}}], \"body_md\": \"Own participant recruitment end-to-end for surveys/interviews/tests: channel selection, quotas, scheduling handoff, funnel monitoring, and compliance-quality gates with explicit fail-fast outputs.\"}, {\"name\": \"jtbd_interview_operator\", \"fexp_description\": \"Operate JTBD interviews and produce coded evidence artifacts\", \"fexp_allow_tools\": \"flexus_policy_document,discovery_interview_capture_api,discovery_transcript_coding_api,discovery_context_import_api\", \"fexp_block_tools\": \"print_widget\", \"skills\": [\"skill_qualitative_coding\"], \"pdoc_output_schemas\": [{\"schema_name\": \"interview_corpus_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"study_id\", \"time_window\", \"target_segment\", \"interviews\", \"coverage_status\", \"limitations\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"interview_corpus\"]}, \"version\": {\"type\": \"string\"}, \"study_id\": {\"type\": \"string\"}, \"time_window\": {\"type\": \"object\", \"required\": [\"start_date\", \"end_date\"], \"additionalProperties\": false, \"properties\": {\"start_date\": {\"type\": \"string\"}, \"end_date\": {\"type\": \"string\"}}}, \"target_segment\": {\"type\": \"string\"}, \"interviews\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"interview_id\", \"source_type\", \"respondent_profile\", \"transcript_ref\", \"coded_events\", \"confidence\"], \"additionalProperties\": false, \"properties\": {\"interview_id\": {\"type\": \"string\"}, \"source_type\": {\"type\": \"string\", \"enum\": [\"live_call\", \"recording_import\", \"async_form\"]}, \"respondent_profile\": {\"type\": \"object\"}, \"transcript_ref\": {\"type\": \"string\"}, \"coded_events\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"event_id\", \"event_type\", \"event_text\", \"evidence_strength\"], \"additionalProperties\": false, \"properties\": {\"event_id\": {\"type\": \"string\"}, \"event_type\": {\"type\": \"string\", \"enum\": [\"struggle\", \"workaround\", \"trigger\", \"decision_criteria\", \"objection\"]}, \"event_text\": {\"type\": \"string\"}, \"evidence_strength\": {\"type\": \"string\", \"enum\": [\"weak\", \"moderate\", \"strong\"]}}}}, \"confidence\": {\"type\": \"number\", \"minimum\": 0, \"maximum\": 1}}}}, \"coverage_status\": {\"type\": \"string\", \"enum\": [\"full\", \"partial\", \"insufficient\"]}, \"limitations\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, {\"schema_name\": \"jtbd_outcomes_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"study_id\", \"job_map\", \"outcomes\", \"forces\", \"confidence\", \"next_checks\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"jtbd_outcomes\"]}, \"version\": {\"type\": \"string\"}, \"study_id\": {\"type\": \"string\"}, \"job_map\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"step_id\", \"step_name\"], \"additionalProperties\": false, \"properties\": {\"step_id\": {\"type\": \"string\"}, \"step_name\": {\"type\": \"string\"}}}}, \"outcomes\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"outcome_id\", \"outcome_statement\", \"underserved_score\", \"supporting_interview_refs\"], \"additionalProperties\": false, \"properties\": {\"outcome_id\": {\"type\": \"string\"}, \"outcome_statement\": {\"type\": \"string\"}, \"underserved_score\": {\"type\": \"number\", \"minimum\": 0, \"maximum\": 1}, \"supporting_interview_refs\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, \"forces\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"force_type\", \"summary\"], \"additionalProperties\": false, \"properties\": {\"force_type\": {\"type\": \"string\", \"enum\": [\"push\", \"pull\", \"habit\", \"anxiety\"]}, \"summary\": {\"type\": \"string\"}}}}, \"confidence\": {\"type\": \"number\", \"minimum\": 0, \"maximum\": 1}, \"next_checks\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, {\"schema_name\": \"discovery_evidence_quality_schema\", \"schema\": {\"type\": \"object\", \"required\": [\"artifact_type\", \"version\", \"study_id\", \"quality_checks\", \"pass_fail\", \"blocking_issues\"], \"additionalProperties\": false, \"properties\": {\"artifact_type\": {\"type\": \"string\", \"enum\": [\"discovery_evidence_quality\"]}, \"version\": {\"type\": \"string\"}, \"study_id\": {\"type\": \"string\"}, \"quality_checks\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"required\": [\"check_id\", \"result\", \"notes\"], \"additionalProperties\": false, \"properties\": {\"check_id\": {\"type\": \"string\"}, \"result\": {\"type\": \"string\", \"enum\": [\"pass\", \"warn\", \"fail\"]}, \"notes\": {\"type\": \"string\"}}}}, \"pass_fail\": {\"type\": \"string\", \"enum\": [\"pass\", \"fail\"]}, \"blocking_issues\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}], \"body_md\": \"Run interviews, capture transcripts, code outcomes, and emit structured evidence payloads; fail fast when sample coverage, consent traceability, or evidence quality checks are below threshold.\"}]")
BOT_SKILLS = json.loads("[{\"name\": \"skill_past_behavior_questioning\", \"description\": \"Past-behavior interview design discipline\", \"body_md\": \"Force past-event phrasing and block hypothetical, leading, or abstract prompts.\"}, {\"name\": \"skill_jtbd_outcome_formatting\", \"description\": \"JTBD outcome normalization\", \"body_md\": \"Convert raw interview language into structured desired-outcome statements.\"}, {\"name\": \"skill_qualitative_coding\", \"description\": \"Qualitative coding and saturation control\", \"body_md\": \"Apply coding consistency, theme merge rules, and saturation checks.\"}]")
