<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tactics Dashboard</title>
  <style id="theme-css"></style>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-card: #21262d;
      --bg-hover: #30363d;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --border-color: #30363d;
      --accent-blue: #58a6ff;
      --accent-green: #3fb950;
      --accent-orange: #d29922;
      --accent-red: #f85149;
      --accent-purple: #a371f7;
      --accent-pink: #db61a2;
      --gradient-meta: linear-gradient(135deg, #0062e0 0%, #19afff 100%);
      --gradient-tiktok: linear-gradient(135deg, #010101 0%, #fe2c55 50%, #25f4ee 100%);
      --gradient-linkedin: linear-gradient(135deg, #0077b5 0%, #00a0dc 100%);
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.5;
      padding: 0;
      min-height: 100vh;
    }
    
    .dashboard {
      max-width: 100%;
      padding: 1.5rem;
    }
    
    /* Header */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-color);
    }
    
    .header h1 {
      font-size: 1.5rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .header h1 .icon {
      font-size: 1.75rem;
    }
    
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .badge-ready { background: rgba(59, 185, 80, 0.15); color: var(--accent-green); }
    .badge-active { background: rgba(88, 166, 255, 0.15); color: var(--accent-blue); }
    
    /* Summary Stats */
    .stats-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .stat-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
    }
    
    .stat-card .value {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--accent-blue);
    }
    
    .stat-card .label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 0.25rem;
    }
    
    /* Section */
    .section {
      margin-bottom: 2rem;
    }
    
    .section-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    /* Campaigns Grid */
    .campaigns-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1rem;
    }
    
    .campaign-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .campaign-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }
    
    .campaign-header {
      padding: 1rem;
      color: white;
      position: relative;
    }
    
    .campaign-header.meta { background: var(--gradient-meta); }
    .campaign-header.tiktok { background: var(--gradient-tiktok); }
    .campaign-header.linkedin { background: var(--gradient-linkedin); }
    
    .campaign-header .channel-icon {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.5rem;
      opacity: 0.8;
    }
    
    .campaign-header h3 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }
    
    .campaign-header .angle {
      font-size: 0.8rem;
      opacity: 0.9;
    }
    
    .campaign-body {
      padding: 1rem;
    }
    
    .campaign-stat {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border-color);
    }
    
    .campaign-stat:last-child { border-bottom: none; }
    
    .campaign-stat .label {
      color: var(--text-secondary);
      font-size: 0.85rem;
    }
    
    .campaign-stat .value {
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .campaign-stat .value.budget {
      color: var(--accent-green);
    }
    
    /* Targeting Pills */
    .targeting-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.75rem;
    }
    
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.35rem 0.65rem;
      border-radius: 20px;
      font-size: 0.75rem;
      background: var(--bg-hover);
      color: var(--text-secondary);
    }
    
    .pill.geo { background: rgba(88, 166, 255, 0.15); color: var(--accent-blue); }
    .pill.age { background: rgba(163, 113, 247, 0.15); color: var(--accent-purple); }
    .pill.interest { background: rgba(210, 153, 34, 0.15); color: var(--accent-orange); }
    
    /* Creatives Section */
    .creatives-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
    }
    
    .creative-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .creative-header {
      padding: 0.75rem 1rem;
      background: var(--bg-card);
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--border-color);
    }
    
    .creative-header .id {
      font-weight: 600;
      font-size: 0.85rem;
    }
    
    .creative-header .format {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      font-size: 0.7rem;
      text-transform: uppercase;
      font-weight: 600;
    }
    
    .format.reel { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
    .format.image { background: rgba(88, 166, 255, 0.15); color: var(--accent-blue); }
    .format.video { background: rgba(163, 113, 247, 0.15); color: var(--accent-purple); }
    
    .creative-preview {
      padding: 1rem;
      background: var(--bg-card);
      border-bottom: 1px solid var(--border-color);
      min-height: 120px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .creative-preview .headline {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }
    
    .creative-preview .description {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    
    .creative-body {
      padding: 1rem;
    }
    
    .creative-body .primary-text {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 1rem;
    }
    
    .creative-cta {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: var(--accent-blue);
      color: white;
      border-radius: 6px;
      font-size: 0.85rem;
      font-weight: 600;
    }
    
    /* Iteration Timeline */
    .timeline {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    
    .timeline-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 1rem;
      position: relative;
    }
    
    .timeline-item.current {
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 1px var(--accent-blue);
    }
    
    .timeline-item .days {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--accent-blue);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
    }
    
    .timeline-item .phase-title {
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .timeline-item .phase-content {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }
    
    /* Landing Preview */
    .landing-preview {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .landing-block {
      padding: 1rem 1.25rem;
      border-bottom: 1px solid var(--border-color);
    }
    
    .landing-block:last-child { border-bottom: none; }
    
    .landing-block .block-type {
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--accent-purple);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
    }
    
    .landing-block.hero {
      background: linear-gradient(135deg, rgba(88, 166, 255, 0.1) 0%, rgba(163, 113, 247, 0.1) 100%);
      padding: 1.5rem;
    }
    
    .landing-block.hero .headline {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }
    
    .landing-block.hero .subheadline {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }
    
    .landing-block.cta {
      background: var(--bg-card);
      text-align: center;
    }
    
    .landing-block.cta .cta-button {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: var(--accent-green);
      color: white;
      border-radius: 8px;
      font-weight: 600;
      margin-top: 0.5rem;
    }
    
    /* Checklist */
    .checklist {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .checklist-item {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 1rem 1.25rem;
      border-bottom: 1px solid var(--border-color);
    }
    
    .checklist-item:last-child { border-bottom: none; }
    
    .checklist-item .checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-radius: 4px;
      flex-shrink: 0;
      margin-top: 2px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    
    .checklist-item .checkbox:hover {
      border-color: var(--accent-blue);
    }
    
    .checklist-item .checkbox.checked {
      background: var(--accent-green);
      border-color: var(--accent-green);
    }
    
    .checklist-item .task {
      flex: 1;
    }
    
    .checklist-item .task-text {
      font-size: 0.9rem;
    }
    
    .checklist-item .task-meta {
      display: flex;
      gap: 1rem;
      margin-top: 0.35rem;
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    
    /* Tracking Section */
    .tracking-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    
    .tracking-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 1rem;
    }
    
    .tracking-card h4 {
      font-size: 0.8rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.75rem;
    }
    
    .event-list {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .event-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
    }
    
    .event-item .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent-blue);
    }
    
    .event-item .dot.conversion {
      background: var(--accent-green);
    }
    
    /* Tabs */
    .tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.5rem;
      overflow-x: auto;
    }
    
    .tab {
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }
    
    .tab:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
    }
    
    .tab.active {
      background: var(--accent-blue);
      color: white;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 3rem;
      color: var(--text-secondary);
    }
    
    .empty-state .icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <div id="app" class="dashboard">
    <div class="empty-state">
      <div class="icon">üìã</div>
      <p>Loading tactics...</p>
    </div>
  </div>

  <script>
    // FormBridge for parent communication
    const FormBridge = {
      listeners: {},
      initialized: false,
      
      init(formId) {
        window.addEventListener('message', (event) => {
          if (event.data && event.data.type) {
            const handler = this.listeners[event.data.type];
            if (handler) handler(event.data);
          }
        });
        this.send('FORM_READY', { formId });
        this.initialized = true;
      },
      
      on(type, callback) {
        this.listeners[type] = callback;
      },
      
      send(type, payload) {
        window.parent.postMessage({ type, ...payload }, '*');
      }
    };

    let tactics = null;
    let currentTab = 'campaigns';

    // Extract tactics data from either wrapped or unwrapped format
    function extractTactics(content) {
      if (!content) return {};
      // Wrapped format: {"tactics": {"meta": {...}, "campaigns": [...]}}
      if (content.tactics && typeof content.tactics === 'object') {
        return content.tactics;
      }
      // Unwrapped legacy format: {"campaigns": [...], ...}
      return content;
    }

    FormBridge.on('INIT', data => {
      tactics = extractTactics(data.content);
      if (data.themeCss) {
        document.getElementById('theme-css').textContent = data.themeCss;
      }
      render();
    });

    FormBridge.on('CONTENT_UPDATE', data => {
      tactics = extractTactics(data.content);
      render();
    });

    FormBridge.init('owl-tactics-dashboard');

    function switchTab(tab) {
      currentTab = tab;
      render();
    }

    function getChannelIcon(channel) {
      const icons = {
        meta: 'üìò',
        tiktok: 'üéµ',
        linkedin: 'üíº',
        google: 'üîç'
      };
      return icons[channel] || 'üì¢';
    }

    function getFormatIcon(format) {
      const icons = {
        reel: 'üé¨',
        image: 'üñºÔ∏è',
        video: 'üìπ'
      };
      return icons[format] || 'üìÑ';
    }

    function render() {
      const app = document.getElementById('app');
      
      if (!tactics || Object.keys(tactics).length === 0) {
        app.innerHTML = `
          <div class="empty-state">
            <div class="icon">üìã</div>
            <p>No tactics data available</p>
          </div>
        `;
        return;
      }

      const campaigns = tactics.campaigns || [];
      const creatives = tactics.creatives || [];
      const landing = tactics.landing || {};
      const tracking = tactics.tracking || {};
      const iterationGuide = tactics.iteration_guide || {};
      const checklist = tactics.execution_checklist || [];
      
      // Calculate stats
      const totalBudget = campaigns.reduce((sum, c) => sum + (c.daily_budget || 0) * (c.duration_days || 30), 0);
      const metaCampaigns = campaigns.filter(c => c.channel === 'meta').length;
      const tiktokCampaigns = campaigns.filter(c => c.channel === 'tiktok').length;
      
      app.innerHTML = `
        <div class="header">
          <h1>
            <span class="icon">ü¶â</span>
            Tactics Plan
          </h1>
          <span class="badge badge-ready">Ready to Launch</span>
        </div>

        <div class="stats-row">
          <div class="stat-card">
            <div class="value">${campaigns.length}</div>
            <div class="label">Campaigns</div>
          </div>
          <div class="stat-card">
            <div class="value">${creatives.length}</div>
            <div class="label">Creatives</div>
          </div>
          <div class="stat-card">
            <div class="value">$${totalBudget.toFixed(0)}</div>
            <div class="label">Total Budget</div>
          </div>
          <div class="stat-card">
            <div class="value">${campaigns[0]?.duration_days || 30}</div>
            <div class="label">Days</div>
          </div>
        </div>

        <div class="tabs">
          <div class="tab ${currentTab === 'campaigns' ? 'active' : ''}" onclick="switchTab('campaigns')">üéØ Campaigns</div>
          <div class="tab ${currentTab === 'creatives' ? 'active' : ''}" onclick="switchTab('creatives')">üé® Creatives</div>
          <div class="tab ${currentTab === 'landing' ? 'active' : ''}" onclick="switchTab('landing')">üè† Landing</div>
          <div class="tab ${currentTab === 'timeline' ? 'active' : ''}" onclick="switchTab('timeline')">üìÖ Timeline</div>
          <div class="tab ${currentTab === 'checklist' ? 'active' : ''}" onclick="switchTab('checklist')">‚úÖ Checklist</div>
          <div class="tab ${currentTab === 'tracking' ? 'active' : ''}" onclick="switchTab('tracking')">üìä Tracking</div>
        </div>

        <div class="tab-content ${currentTab === 'campaigns' ? 'active' : ''}">
          ${renderCampaigns(campaigns)}
        </div>

        <div class="tab-content ${currentTab === 'creatives' ? 'active' : ''}">
          ${renderCreatives(creatives)}
        </div>

        <div class="tab-content ${currentTab === 'landing' ? 'active' : ''}">
          ${renderLanding(landing)}
        </div>

        <div class="tab-content ${currentTab === 'timeline' ? 'active' : ''}">
          ${renderTimeline(iterationGuide)}
        </div>

        <div class="tab-content ${currentTab === 'checklist' ? 'active' : ''}">
          ${renderChecklist(checklist)}
        </div>

        <div class="tab-content ${currentTab === 'tracking' ? 'active' : ''}">
          ${renderTracking(tracking)}
        </div>
      `;
    }

    function renderCampaigns(campaigns) {
      if (!campaigns.length) return '<div class="empty-state"><p>No campaigns defined</p></div>';
      
      return `
        <div class="campaigns-grid">
          ${campaigns.map(camp => {
            const adset = camp.adsets?.[0] || {};
            const audience = adset.audience || {};
            const angle = adset.adset_id?.split('_').pop() || '';
            
            return `
              <div class="campaign-card">
                <div class="campaign-header ${camp.channel}">
                  <h3>${camp.campaign_id}</h3>
                  <div class="angle">${angle} angle</div>
                  <span class="channel-icon">${getChannelIcon(camp.channel)}</span>
                </div>
                <div class="campaign-body">
                  <div class="campaign-stat">
                    <span class="label">Daily Budget</span>
                    <span class="value budget">$${camp.daily_budget?.toFixed(2) || '0.00'}/day</span>
                  </div>
                  <div class="campaign-stat">
                    <span class="label">Duration</span>
                    <span class="value">${camp.duration_days || 30} days</span>
                  </div>
                  <div class="campaign-stat">
                    <span class="label">Total</span>
                    <span class="value">$${((camp.daily_budget || 0) * (camp.duration_days || 30)).toFixed(0)}</span>
                  </div>
                  <div class="campaign-stat">
                    <span class="label">Objective</span>
                    <span class="value">${camp.objective || 'traffic'}</span>
                  </div>
                  <div class="targeting-pills">
                    ${(audience.countries || []).map(c => `<span class="pill geo">üåç ${c}</span>`).join('')}
                    ${audience.age_range ? `<span class="pill age">üë§ ${audience.age_range[0]}-${audience.age_range[1]}</span>` : ''}
                  </div>
                  <div class="targeting-pills" style="margin-top: 0.5rem">
                    ${(audience.interests || []).slice(0, 3).map(i => `<span class="pill interest">${i}</span>`).join('')}
                    ${(audience.interests || []).length > 3 ? `<span class="pill">+${audience.interests.length - 3}</span>` : ''}
                  </div>
                </div>
              </div>
            `;
          }).join('')}
        </div>
      `;
    }

    function renderCreatives(creatives) {
      if (!creatives.length) return '<div class="empty-state"><p>No creatives defined</p></div>';
      
      return `
        <div class="creatives-grid">
          ${creatives.map(cr => `
            <div class="creative-card">
              <div class="creative-header">
                <span class="id">${cr.creative_id}</span>
                <span class="format ${cr.format}">${getFormatIcon(cr.format)} ${cr.format}</span>
              </div>
              <div class="creative-preview">
                <div class="headline">${cr.headline || ''}</div>
                <div class="description">${cr.description || ''}</div>
              </div>
              <div class="creative-body">
                <div class="primary-text">${cr.primary_text || ''}</div>
                <div class="creative-cta">
                  ${cr.cta || 'Learn More'} ‚Üí
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function renderLanding(landing) {
      if (!landing.structure) return '<div class="empty-state"><p>No landing page defined</p></div>';
      
      return `
        <div class="section">
          <div class="section-title">üéØ Landing Page Structure</div>
          <div class="landing-preview">
            ${landing.structure.map(block => {
              if (block.block === 'hero') {
                return `
                  <div class="landing-block hero">
                    <div class="block-type">Hero</div>
                    <div class="headline">${block.headline || ''}</div>
                    <div class="subheadline">${block.subheadline || ''}</div>
                  </div>
                `;
              }
              if (block.block === 'cta') {
                return `
                  <div class="landing-block cta">
                    <div class="block-type">Call to Action</div>
                    <div>${block.text || ''}</div>
                    <div class="cta-button">${block.button || 'Get Started'} ‚Üí</div>
                  </div>
                `;
              }
              if (block.block === 'how_it_works') {
                return `
                  <div class="landing-block">
                    <div class="block-type">How It Works</div>
                    <ol style="margin-left: 1.25rem; color: var(--text-secondary);">
                      ${(block.steps || []).map(s => `<li style="margin-bottom: 0.5rem;">${s}</li>`).join('')}
                    </ol>
                  </div>
                `;
              }
              return `
                <div class="landing-block">
                  <div class="block-type">${block.block}</div>
                  <div style="color: var(--text-secondary);">${block.content || ''}</div>
                </div>
              `;
            }).join('')}
          </div>
        </div>
        
        ${landing.variants ? `
          <div class="section">
            <div class="section-title">üîÄ Landing Variants</div>
            <div class="targeting-pills">
              ${landing.variants.map(v => `<span class="pill">${v.variant_id}: ${v.focus}</span>`).join('')}
            </div>
          </div>
        ` : ''}
      `;
    }

    function renderTimeline(guide) {
      if (!guide || Object.keys(guide).length === 0) {
        return '<div class="empty-state"><p>No iteration guide defined</p></div>';
      }
      
      const phases = [
        { key: 'day_1_3', title: 'Monitor & Kill', days: 'Day 1-3' },
        { key: 'day_4_7', title: 'Optimize', days: 'Day 4-7' },
        { key: 'day_8_14', title: 'Scale Winners', days: 'Day 8-14' },
        { key: 'day_15_30', title: 'Analyze & Plan', days: 'Day 15-30' },
      ];
      
      return `
        <div class="timeline">
          ${phases.map(phase => guide[phase.key] ? `
            <div class="timeline-item">
              <div class="days">${phase.days}</div>
              <div class="phase-title">${phase.title}</div>
              <div class="phase-content">${guide[phase.key]}</div>
            </div>
          ` : '').join('')}
        </div>
      `;
    }

    function renderChecklist(checklist) {
      if (!checklist.length) return '<div class="empty-state"><p>No checklist items</p></div>';
      
      return `
        <div class="checklist">
          ${checklist.map((item, i) => `
            <div class="checklist-item">
              <div class="checkbox" onclick="this.classList.toggle('checked')"></div>
              <div class="task">
                <div class="task-text">${item.task}</div>
                <div class="task-meta">
                  <span>üë§ ${item.owner || 'TBD'}</span>
                  <span>üìÖ ${item.deadline || 'No deadline'}</span>
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function renderTracking(tracking) {
      if (!tracking.events && !tracking.utm_schema) {
        return '<div class="empty-state"><p>No tracking configuration</p></div>';
      }
      
      return `
        <div class="tracking-grid">
          ${tracking.events ? `
            <div class="tracking-card">
              <h4>üìä Events to Track</h4>
              <div class="event-list">
                ${tracking.events.map(e => `
                  <div class="event-item">
                    <span class="dot ${e.is_conversion ? 'conversion' : ''}"></span>
                    <span>${e.name}${e.is_conversion ? ' ‚≠ê' : ''}</span>
                  </div>
                `).join('')}
              </div>
            </div>
          ` : ''}
          
          ${tracking.pixels ? `
            <div class="tracking-card">
              <h4>üéØ Pixel Mapping</h4>
              ${tracking.pixels.map(p => `
                <div style="margin-bottom: 0.75rem;">
                  <strong style="color: var(--accent-blue);">${p.platform}</strong>
                  ${Object.entries(p.event_mapping || {}).map(([k, v]) => `
                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.25rem;">
                      ${k} ‚Üí ${v}
                    </div>
                  `).join('')}
                </div>
              `).join('')}
            </div>
          ` : ''}
          
          ${tracking.utm_schema ? `
            <div class="tracking-card">
              <h4>üîó UTM Schema</h4>
              ${Object.entries(tracking.utm_schema).map(([k, v]) => `
                <div style="font-size: 0.85rem; margin-bottom: 0.35rem;">
                  <span style="color: var(--text-muted);">utm_${k}:</span>
                  <span style="color: var(--accent-orange);">${v}</span>
                </div>
              `).join('')}
            </div>
          ` : ''}
        </div>
      `;
    }
  </script>
</body>
</html>


